name: –î–Ω–µ–≤–Ω–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è (Python –≤–µ—Ä—Å–∏—è)

on:
  workflow_dispatch:

jobs:
  track-mood:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª Python
        run: |
          python3 -c "
          from datetime import datetime
          import os
          
          filename = 'mood_diary.txt'
          today = datetime.utcnow().strftime('%Y-%m-%d')
          
          # –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
          if not os.path.exists(filename):
              with open(filename, 'w', encoding='utf-8') as f:
                  f.write('–î–ù–ï–í–ù–ò–ö –ù–ê–°–¢–†–û–ï–ù–ò–Ø\\n\\n')
          
          # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
          with open(filename, 'r', encoding='utf-8') as f:
              lines = f.readlines()
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–µ–≥–æ–¥–Ω—è—à–Ω—è—è –¥–∞—Ç–∞
          today_found = any(today in line for line in lines)
          
          if not today_found:
              with open(filename, 'a', encoding='utf-8') as f:
                  f.write(f'{today}: -----------------------\\n')
              print(f'‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –∑–∞ {today}')
          else:
              print(f'‚ö†Ô∏è –ó–∞–ø–∏—Å—å –∑–∞ {today} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç')
          
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
          print('\\nüìÑ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:')
          with open(filename, 'r', encoding='utf-8') as f:
              print(f.read())
          "
      
      - name: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
        run: |
          git config --global user.email "actions@github.com"
          git config --global user.name "GitHub Actions"
          git add mood_diary.txt
          git commit -m "Update mood diary" || echo "No changes"
          git push
